<?xml version="1.0"?>
<robot name="dof_arm">

  <link name="world"/>

  <joint name="world_to_base" type="fixed">
    <parent link="world"/>
    <child link="base_link"/>
    <origin xyz="0 0 0.0" rpy="0 0 0"/> 
  </joint>

  <link name="base_link">
    <visual>
      <origin xyz="0 0 0.025" rpy="0 0 0"/>
      <geometry>
        <cylinder radius="0.05" length="0.05"/>
      </geometry>
      <material name="gray">
        <color rgba="0.6 0.6 0.6 1"/>
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0.025" rpy="0 0 0"/>
      <geometry>
        <cylinder radius="0.05" length="0.05"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0.025" rpy="0 0 0"/>
      <mass value="5.0"/> <inertia ixx="0.005" ixy="0.0" ixz="0.0" iyy="0.005" iyz="0.0" izz="0.005"/>
    </inertial>
  </link>

  <link name="link1">
    <visual>
      <origin xyz="0.1 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.2 0.03 0.03"/>
      </geometry>
      <material name="blue">
        <color rgba="0.2 0.2 1 1"/>
      </material>
    </visual>
    <collision>
      <origin xyz="0.1 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.2 0.03 0.03"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0.1 0 0" rpy="0 0 0"/>
      <mass value="0.5"/>
      <inertia ixx="0.0001" ixy="0.0" ixz="0.0" iyy="0.002" iyz="0.0" izz="0.002"/>
    </inertial>
  </link>

  <link name="link2">
    <visual>
      <origin xyz="0.1 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.2 0.025 0.025"/>
      </geometry>
      <material name="green">
        <color rgba="0.2 1 0.2 1"/>
      </material>
    </visual>
    <collision>
      <origin xyz="0.1 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.2 0.025 0.025"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0.1 0 0" rpy="0 0 0"/>
      <mass value="0.3"/>
      <inertia ixx="0.0001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001"/>
    </inertial>
  </link>

  <link name="ee_link">
    <visual>
      <origin xyz="0.025 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.05 0.05 0.05"/>
      </geometry>
      <material name="red">
        <color rgba="1 0.2 0.2 1"/>
      </material>
    </visual>
    <collision>
      <origin xyz="0.025 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.05 0.05 0.05"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0.025 0 0" rpy="0 0 0"/>
      <mass value="0.1"/>
      <inertia ixx="0.00005" ixy="0.0" ixz="0.0" iyy="0.00005" iyz="0.0" izz="0.00005"/>
    </inertial>
  </link>

  <joint name="joint1" type="revolute">
    <parent link="base_link"/>
    <child link="link1"/>
    <origin xyz="0 0 0.05" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <limit lower="-2.5" upper="2.5" effort="50.0" velocity="5.0"/>
    <dynamics damping="0.5" friction="0.1"/> 
  </joint>

  <joint name="joint2" type="revolute">
    <parent link="link1"/>
    <child link="link2"/>
    <origin xyz="0.2 0 0" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <limit lower="-2.5" upper="2.5" effort="50.0" velocity="5.0"/>
    <dynamics damping="0.5" friction="0.1"/>
  </joint>

  <joint name="joint_ee" type="fixed">
    <parent link="link2"/>
    <child link="ee_link"/>
    <origin xyz="0.2 0 0" rpy="0 0 0"/>
  </joint>

  <gazebo>
    <plugin filename="libignition-gazebo-joint-state-publisher-system.so" 
            name="ignition::gazebo::systems::JointStatePublisher">
    </plugin>
    
    <plugin filename="libignition-gazebo-joint-position-controller-system.so" 
            name="ignition::gazebo::systems::JointPositionController">
      <joint_name>joint1</joint_name>
      <p_gain>500.0</p_gain>
      <i_gain>0.0</i_gain>  <d_gain>10.0</d_gain>
      <topic>/model/dof_arm/joint1/cmd_pos</topic>
    </plugin>

    <plugin filename="libignition-gazebo-joint-position-controller-system.so" 
            name="ignition::gazebo::systems::JointPositionController">
      <joint_name>joint2</joint_name>
      <p_gain>500.0</p_gain>
      <i_gain>0.0</i_gain>
      <d_gain>10.0</d_gain>
      <topic>/model/dof_arm/joint2/cmd_pos</topic>
    </plugin>
  </gazebo>

  <gazebo reference="base_link">
    <material><ambient>0.6 0.6 0.6 1</ambient><diffuse>0.6 0.6 0.6 1</diffuse></material>
  </gazebo>
  <gazebo reference="link1">
    <material><ambient>0.2 0.2 1 1</ambient><diffuse>0.2 0.2 1 1</diffuse></material>
  </gazebo>
  <gazebo reference="link2">
    <material><ambient>0.2 1 0.2 1</ambient><diffuse>0.2 1 0.2 1</diffuse></material>
  </gazebo>
  <gazebo reference="ee_link">
    <material><ambient>1 0.2 0.2 1</ambient><diffuse>1 0.2 0.2 1</diffuse></material>
  </gazebo>

</robot>
